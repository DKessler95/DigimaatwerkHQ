<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Digimaatwerk CMS</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700&display=swap">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .nc-app-header {
      background-color: #0F172A !important;
    }
    :root {
      --primary-color: #0F172A;
      --secondary-color: #0EA5E9;
    }
  </style>
</head>
<body>
  <!-- Include the script that builds the page and powers Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    // Preview styles - match your frontend styling
    CMS.registerPreviewStyle("/admin/preview.css");
    
    // Custom preview templates for content types
    const ServicePreview = createClass({
      render: function() {
        const entry = this.props.entry;
        const title = entry.getIn(['data', 'title']);
        const shortDescription = entry.getIn(['data', 'short_description']);
        const features = entry.getIn(['data', 'features']) || [];
        const techStack = entry.getIn(['data', 'tech_stack']) || [];
        const content = this.props.widgetFor('body');
        
        return h('div', {className: 'service-preview'},
          h('h1', {}, title),
          h('div', {className: 'service-description'}, shortDescription),
          
          h('h2', {}, 'Features'),
          h('div', {className: 'feature-list'},
            features.map((feature, index) => {
              return h('div', {className: 'feature-item', key: index},
                h('h3', {}, feature.getIn(['name'])),
                h('p', {}, feature.getIn(['description']))
              );
            })
          ),
          
          h('h2', {}, 'Technologies'),
          h('div', {className: 'tech-stack'},
            techStack.map((tech, index) => {
              return h('div', {className: 'tech-item', key: index},
                h('strong', {}, tech.getIn(['name']) + ': '),
                h('span', {}, tech.getIn(['description']))
              );
            })
          ),
          
          h('h2', {}, 'Content'),
          h('div', {}, content)
        );
      }
    });
    
    CMS.registerPreviewTemplate('services', ServicePreview);
    
    // Localization
    const nl = {
      app: {
        header: {
          content: 'Inhoud',
          workflow: 'Workflow',
          media: 'Media',
          quickAdd: 'Snel toevoegen',
        },
        notFoundPage: {
          header: 'Niet gevonden',
        },
        errorBoundary: {
          detailsHeading: 'Details',
          reportError: 'Fout melden',
          retryMessage: 'Opnieuw proberen',
        },
        settingsDropdown: {
          logOut: 'Uitloggen',
        },
      },
      collection: {
        sidebar: {
          collections: 'Collecties',
          allCollections: 'Alle collecties',
          searchAll: 'Alles zoeken',
          searchIn: 'Zoeken in',
        },
        collectionTop: {
          sortBy: 'Sorteren op',
          viewAs: 'Bekijken als',
          newButton: 'Nieuwe %{collectionLabel}',
          ascending: 'Oplopend',
          descending: 'Aflopend',
          searchResults: 'Zoekresultaten voor "%{searchTerm}"',
          searchResultsInCollection: 'Zoekresultaten voor "%{searchTerm}" in %{collection}',
          filterBy: 'Filteren op',
          groupBy: 'Groeperen op',
        },
      },
      editor: {
        editorControl: {
          field: {
            optional: 'optioneel',
          },
        },
        editorControlPane: {
          widget: {
            required: '%{fieldLabel} is vereist.',
            regexPattern: '%{fieldLabel} komt niet overeen met het patroon: %{pattern}.',
            processing: '%{fieldLabel} wordt verwerkt.',
            range: '%{fieldLabel} moet tussen %{minValue} en %{maxValue} liggen.',
            min: '%{fieldLabel} moet ten minste %{minValue} zijn.',
            max: '%{fieldLabel} moet %{maxValue} of minder zijn.',
            rangeCount: '%{fieldLabel} moet tussen %{minCount} en %{maxCount} items hebben.',
            rangeCountExact: '%{fieldLabel} moet precies %{count} items hebben.',
            minCount: '%{fieldLabel} moet ten minste %{minCount} item hebben.',
            maxCount: '%{fieldLabel} moet %{maxCount} of minder items hebben.',
            invalidPath: '"%{path}" is geen geldig pad.',
            pathExists: 'Pad "%{path}" bestaat al.',
          },
        },
      },
    };
    
    CMS.registerLocale('nl', nl);
    
    // Make createClass available for preview templates
    var createClass = React.createClass;
    var h = React.createElement;
    
    // Add custom admin links
    const addAdminLinks = () => {
      // Wait a bit for CMS to render
      setTimeout(() => {
        // Get the app header div to append our links
        const appHeader = document.querySelector('.nc-appHeader-toolbar');
        
        if (appHeader) {
          // Create link to integrations documentation
          const integrationsLink = document.createElement('a');
          integrationsLink.href = '/admin/integrations.html';
          integrationsLink.target = '_blank';
          integrationsLink.className = 'nc-appHeader-toolbarLink';
          integrationsLink.textContent = 'Integraties';
          integrationsLink.style.marginRight = '20px';
          
          // Inject the link into the header
          appHeader.appendChild(integrationsLink);
        }
      }, 1000);
    };
    
    // Initialize the CMS
    window.initCMS = () => {
      CMS.init();
      addAdminLinks();
    };
    
    // Load React and ReactDOM for preview templates
    const script = document.createElement('script');
    script.src = 'https://unpkg.com/react@16/umd/react.development.js';
    script.onload = () => {
      const reactDOM = document.createElement('script');
      reactDOM.src = 'https://unpkg.com/react-dom@16/umd/react-dom.development.js';
      reactDOM.onload = window.initCMS;
      document.body.appendChild(reactDOM);
    };
    document.body.appendChild(script);
  </script>
</body>
</html>